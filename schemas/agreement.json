{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Agreement Schema",
  "description": "Schema for structured agreement/contract data extraction",
  "type": "object",
  "properties": {
    "document_type": {
      "type": "string",
      "const": "agreement"
    },
    "document_path": {
      "type": "string",
      "description": "Path to source document"
    },
    "metadata": {
      "type": "object",
      "properties": {
        "agreement_type": {
          "type": "string",
          "enum": ["NDA", "MSA", "SOW", "SLA", "License", "Partnership", "Employment", "Other"],
          "description": "Type of agreement"
        },
        "agreement_id": {
          "type": "string",
          "description": "Agreement reference number"
        },
        "effective_date": {
          "type": "string",
          "format": "date",
          "description": "When agreement becomes effective (ISO 8601)"
        },
        "expiry_date": {
          "type": "string",
          "format": "date",
          "description": "When agreement expires (ISO 8601)"
        },
        "term_duration": {
          "type": "string",
          "description": "Duration of agreement (e.g., '2 years')"
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Overall extraction confidence"
        }
      },
      "required": ["agreement_type"]
    },
    "parties": {
      "type": "array",
      "description": "Parties involved in the agreement",
      "items": {
        "type": "object",
        "properties": {
          "role": {
            "type": "string",
            "description": "Role in agreement (e.g., 'Party A', 'Vendor', 'Client')"
          },
          "name": {
            "type": "string",
            "description": "Legal entity name"
          },
          "address": {
            "type": "string",
            "description": "Registered address"
          },
          "representative": {
            "type": "string",
            "description": "Authorized representative name"
          },
          "title": {
            "type": "string",
            "description": "Representative title"
          }
        },
        "required": ["role", "name"]
      },
      "minItems": 2
    },
    "key_terms": {
      "type": "object",
      "properties": {
        "scope": {
          "type": "string",
          "description": "Scope of services/work"
        },
        "payment_terms": {
          "type": "string",
          "description": "Payment structure and terms"
        },
        "termination_clause": {
          "type": "string",
          "description": "Termination conditions"
        },
        "notice_period": {
          "type": "string",
          "description": "Required notice period for termination"
        },
        "liability_cap": {
          "type": "string",
          "description": "Liability limitation amount"
        },
        "indemnification": {
          "type": "string",
          "description": "Indemnification provisions"
        },
        "confidentiality": {
          "type": "string",
          "description": "Confidentiality terms"
        },
        "governing_law": {
          "type": "string",
          "description": "Governing law and jurisdiction"
        },
        "dispute_resolution": {
          "type": "string",
          "description": "Method for resolving disputes (arbitration, litigation, etc.)"
        }
      }
    },
    "obligations": {
      "type": "array",
      "description": "Specific obligations of parties",
      "items": {
        "type": "object",
        "properties": {
          "party": {
            "type": "string",
            "description": "Which party has this obligation"
          },
          "obligation": {
            "type": "string",
            "description": "Description of obligation"
          },
          "deadline": {
            "type": "string",
            "description": "Deadline or timeframe"
          },
          "deliverable": {
            "type": "string",
            "description": "Expected deliverable"
          }
        },
        "required": ["party", "obligation"]
      }
    },
    "penalties": {
      "type": "array",
      "description": "Penalty clauses",
      "items": {
        "type": "object",
        "properties": {
          "condition": {
            "type": "string",
            "description": "Condition triggering penalty"
          },
          "penalty": {
            "type": "string",
            "description": "Penalty description"
          },
          "amount": {
            "type": "string",
            "description": "Penalty amount if applicable"
          }
        }
      }
    },
    "renewal_terms": {
      "type": "object",
      "properties": {
        "auto_renewal": {
          "type": "boolean",
          "description": "Whether agreement auto-renews"
        },
        "renewal_period": {
          "type": "string",
          "description": "Renewal period (e.g., '1 year')"
        },
        "renewal_notice_period": {
          "type": "string",
          "description": "Notice period required to prevent renewal"
        },
        "renewal_terms_change": {
          "type": "string",
          "description": "Whether terms can change upon renewal"
        }
      }
    },
    "signatures": {
      "type": "array",
      "description": "Signature information",
      "items": {
        "type": "object",
        "properties": {
          "party": {
            "type": "string",
            "description": "Party signing"
          },
          "signatory": {
            "type": "string",
            "description": "Name of person signing"
          },
          "title": {
            "type": "string",
            "description": "Title of signatory"
          },
          "date": {
            "type": "string",
            "format": "date",
            "description": "Signature date"
          },
          "detected": {
            "type": "boolean",
            "description": "Whether signature was detected in document"
          }
        },
        "required": ["party"]
      }
    },
    "custom_extractions": {
      "type": "object",
      "description": "Additional custom fields from user prompts"
    },
    "extraction_timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "When extraction was performed"
    }
  },
  "required": ["document_type", "metadata", "parties"]
}
