{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://docai.dev/schemas/custom/receipt.json",
  "title": "Receipt Extraction Schema",
  "description": "Schema for extracted receipt data",
  "type": "object",
  "required": ["store", "transaction", "line_items", "totals"],
  "properties": {
    "store": {
      "type": "object",
      "description": "Store information",
      "properties": {
        "name": {
          "type": "string",
          "description": "Store name or brand"
        },
        "address": {
          "type": "string",
          "description": "Store address"
        },
        "phone": {
          "type": "string",
          "description": "Store phone number"
        },
        "store_id": {
          "type": "string",
          "description": "Store ID or location code"
        }
      }
    },
    "transaction": {
      "type": "object",
      "description": "Transaction details",
      "required": ["receipt_number", "date"],
      "properties": {
        "receipt_number": {
          "type": "string",
          "description": "Receipt or transaction number"
        },
        "date": {
          "type": "string",
          "format": "date",
          "description": "Date of purchase"
        },
        "time": {
          "type": "string",
          "format": "time",
          "description": "Time of purchase"
        },
        "cashier": {
          "type": "string",
          "description": "Cashier name or ID"
        },
        "register": {
          "type": "string",
          "description": "Register or terminal number"
        }
      }
    },
    "line_items": {
      "type": "array",
      "description": "Purchased items",
      "items": {
        "type": "object",
        "required": ["description", "quantity", "amount"],
        "properties": {
          "description": {
            "type": "string",
            "description": "Item name or description"
          },
          "sku": {
            "type": "string",
            "description": "SKU or item code"
          },
          "quantity": {
            "type": "number",
            "description": "Quantity purchased"
          },
          "unit_price": {
            "type": "number",
            "description": "Price per unit"
          },
          "amount": {
            "type": "number",
            "description": "Line total"
          },
          "discount": {
            "type": "number",
            "description": "Discount applied to item"
          }
        }
      }
    },
    "totals": {
      "type": "object",
      "description": "Payment totals",
      "required": ["total"],
      "properties": {
        "subtotal": {
          "type": "number",
          "description": "Subtotal before tax"
        },
        "tax": {
          "type": "number",
          "description": "Total tax amount"
        },
        "tax_breakdown": {
          "type": "array",
          "description": "Tax breakdown by type",
          "items": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",
                "description": "Tax type (e.g., 'state', 'local')"
              },
              "rate": {
                "type": "number",
                "description": "Tax rate percentage"
              },
              "amount": {
                "type": "number",
                "description": "Tax amount"
              }
            }
          }
        },
        "total": {
          "type": "number",
          "description": "Total amount"
        },
        "currency": {
          "type": "string",
          "default": "USD",
          "description": "Currency code"
        }
      }
    },
    "payment": {
      "type": "object",
      "description": "Payment information",
      "properties": {
        "method": {
          "type": "string",
          "enum": ["cash", "credit", "debit", "check", "gift_card", "mobile", "other"],
          "description": "Payment method"
        },
        "card_last_four": {
          "type": "string",
          "pattern": "^[0-9]{4}$",
          "description": "Last 4 digits of card"
        },
        "amount_tendered": {
          "type": "number",
          "description": "Amount tendered (for cash)"
        },
        "change": {
          "type": "number",
          "description": "Change given"
        }
      }
    },
    "promotions": {
      "type": "array",
      "description": "Coupons and promotions applied",
      "items": {
        "type": "object",
        "properties": {
          "code": {
            "type": "string",
            "description": "Promotion code"
          },
          "description": {
            "type": "string",
            "description": "Promotion description"
          },
          "discount": {
            "type": "number",
            "description": "Discount amount"
          }
        }
      }
    },
    "loyalty": {
      "type": "object",
      "description": "Loyalty program information",
      "properties": {
        "member_id": {
          "type": "string",
          "description": "Loyalty member ID"
        },
        "points_earned": {
          "type": "number",
          "description": "Points earned on this transaction"
        },
        "points_redeemed": {
          "type": "number",
          "description": "Points redeemed"
        },
        "points_balance": {
          "type": "number",
          "description": "Points balance after transaction"
        }
      }
    },
    "metadata": {
      "type": "object",
      "description": "Extraction metadata",
      "properties": {
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Overall extraction confidence"
        },
        "extraction_timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "When extraction was performed"
        }
      }
    }
  }
}
