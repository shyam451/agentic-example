{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "KYC Document Schema",
  "description": "Schema for structured KYC (Know Your Customer) document data extraction",
  "type": "object",
  "properties": {
    "document_type": {
      "type": "string",
      "const": "kyc"
    },
    "document_path": {
      "type": "string",
      "description": "Path to source document"
    },
    "metadata": {
      "type": "object",
      "properties": {
        "document_id": {
          "type": "string",
          "description": "Document identifier (passport number, license number, etc.)"
        },
        "document_subtype": {
          "type": "string",
          "enum": ["passport", "driver_license", "national_id", "utility_bill", "bank_statement", "other"],
          "description": "Specific type of KYC document"
        },
        "issue_date": {
          "type": "string",
          "format": "date",
          "description": "Date document was issued (ISO 8601)"
        },
        "expiry_date": {
          "type": "string",
          "format": "date",
          "description": "Document expiration date (ISO 8601)"
        },
        "issuing_authority": {
          "type": "string",
          "description": "Authority that issued the document"
        },
        "issuing_country": {
          "type": "string",
          "description": "Country code (ISO 3166)"
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Overall extraction confidence"
        }
      },
      "required": ["document_id", "document_subtype"]
    },
    "personal_info": {
      "type": "object",
      "properties": {
        "full_name": {
          "type": "string",
          "description": "Full legal name"
        },
        "first_name": {
          "type": "string",
          "description": "First/given name"
        },
        "last_name": {
          "type": "string",
          "description": "Last/family name"
        },
        "middle_name": {
          "type": "string",
          "description": "Middle name or initial"
        },
        "date_of_birth": {
          "type": "string",
          "format": "date",
          "description": "Date of birth (ISO 8601)"
        },
        "place_of_birth": {
          "type": "string",
          "description": "Place of birth"
        },
        "nationality": {
          "type": "string",
          "description": "Nationality"
        },
        "gender": {
          "type": "string",
          "enum": ["M", "F", "X", "Other"],
          "description": "Gender"
        }
      },
      "required": ["full_name"]
    },
    "address": {
      "type": "object",
      "properties": {
        "street": {
          "type": "string",
          "description": "Street address"
        },
        "city": {
          "type": "string",
          "description": "City"
        },
        "state": {
          "type": "string",
          "description": "State/province"
        },
        "postal_code": {
          "type": "string",
          "description": "Postal/ZIP code"
        },
        "country": {
          "type": "string",
          "description": "Country"
        },
        "full_address": {
          "type": "string",
          "description": "Complete formatted address"
        }
      }
    },
    "verification": {
      "type": "object",
      "description": "Document verification and security features",
      "properties": {
        "photo_present": {
          "type": "boolean",
          "description": "Whether document contains a photo"
        },
        "photo_extracted": {
          "type": "boolean",
          "description": "Whether photo was successfully extracted"
        },
        "mrz_data": {
          "type": "object",
          "description": "Machine Readable Zone data (for passports)",
          "properties": {
            "document_type": {"type": "string"},
            "issuing_country": {"type": "string"},
            "surname": {"type": "string"},
            "given_names": {"type": "string"},
            "document_number": {"type": "string"},
            "nationality": {"type": "string"},
            "date_of_birth": {"type": "string"},
            "sex": {"type": "string"},
            "expiry_date": {"type": "string"},
            "personal_number": {"type": "string"}
          }
        },
        "security_features_detected": {
          "type": "array",
          "description": "Security features detected in document",
          "items": {
            "type": "string"
          }
        },
        "document_authentic": {
          "type": "boolean",
          "description": "Whether document appears authentic"
        },
        "verification_confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Confidence in document authenticity"
        },
        "tamper_detection": {
          "type": "object",
          "properties": {
            "tampered": {"type": "boolean"},
            "evidence": {"type": "string"}
          }
        }
      }
    },
    "additional_info": {
      "type": "object",
      "description": "Additional document-specific information",
      "properties": {
        "document_holder_signature": {
          "type": "boolean",
          "description": "Whether signature is present"
        },
        "endorsements": {
          "type": "array",
          "description": "Any endorsements on document (e.g., license classes)",
          "items": {"type": "string"}
        },
        "restrictions": {
          "type": "array",
          "description": "Any restrictions noted on document",
          "items": {"type": "string"}
        }
      }
    },
    "utility_bill_specific": {
      "type": "object",
      "description": "Fields specific to utility bills",
      "properties": {
        "utility_type": {
          "type": "string",
          "enum": ["electricity", "water", "gas", "internet", "phone", "other"]
        },
        "account_number": {"type": "string"},
        "billing_period": {"type": "string"},
        "amount_due": {"type": "number"},
        "due_date": {"type": "string", "format": "date"}
      }
    },
    "custom_extractions": {
      "type": "object",
      "description": "Additional custom fields from user prompts"
    },
    "extraction_timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "When extraction was performed"
    }
  },
  "required": ["document_type", "metadata", "personal_info"]
}
